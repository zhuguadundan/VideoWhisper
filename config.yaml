# 视频转文本处理系统配置

# API配置
apis:
  siliconflow:
    base_url: "https://api.siliconflow.cn/v1"
    api_key: ""  # 请通过网页设置页面配置
    model: "FunAudioLLM/SenseVoiceSmall"
  
  openai:
    api_key: ""  # 请通过网页设置页面配置
    model: "gpt-4"
    base_url: ""  # 可选
  
  gemini:
    api_key: ""  # 请通过网页设置页面配置
    base_url: ""  # 可选，留空使用默认地址
    model: "gemini-pro"

# 系统配置
system:
  temp_dir: "./temp"
  output_dir: "./output"
  max_file_size: 500  # MB
  audio_format: "wav"
  audio_sample_rate: 16000

# 处理参数（可选，均有默认值，按需覆盖）
processing:
  long_audio_threshold_seconds: 300      # 超过此时长视为长音频
  segment_duration_seconds: 300          # 长音频分段长度
  max_consecutive_failures: 3            # 分段转写连续失败上限
  short_audio_max_retries: 3             # 短音频重试次数
  retry_sleep_short_seconds: 1.0         # 成功或轻微退避等待
  retry_sleep_long_seconds: 2.0          # 失败后的退避等待

# 安全配置（可选）
security:
  # 连接测试接口允许访问的 API 域名白名单（可选）。
  # 留空表示不限制（仍强制 https 且禁止本地/内网地址）。
  allowed_api_hosts: []
  # 是否允许 http（样例默认关闭；可用环境变量 ALLOW_INSECURE_HTTP=true 放开以兼容旧环境）
  allow_insecure_http: false
  # 是否允许私网/本地地址（样例默认关闭；可用 ALLOW_PRIVATE_ADDRESSES=true 放开）
  allow_private_addresses: false
  # 是否强制启用域名白名单（默认不强制；若为 true 且白名单不为空，则必须匹配）
  enforce_api_hosts_whitelist: false

# Web服务配置
web:
  host: "0.0.0.0"
  port: 5000
  debug: true

# HTTPS配置
https:
  enabled: true   # 是否启用HTTPS（默认启用）
  port: 5443      # HTTPS端口
  host: "0.0.0.0"
  auto_generate: true  # 是否自动生成自签名证书
  domain: "localhost"  # 证书域名
  country: "CN"        # 国家代码
  state: "Beijing"     # 州/省
  organization: "VideoWhisper Self-Signed"  # 组织名称
  cert_file: "config/cert.pem"  # 证书文件路径
  key_file: "config/key.pem"    # 私钥文件路径

# 视频下载配置
downloader:
  # 通用配置
  general:
    format: "best[height<=720]/best"  # 视频格式
    audio_format: "bestaudio/best"    # 音频格式
    quiet: false                      # 静默模式

# 文件上传配置
upload:
  max_upload_size: 500              # 最大上传文件大小（MB），可用环境变量 MAX_UPLOAD_SIZE_MB 覆盖
  upload_chunk_size: 5              # 分块上传大小（MB）
  allowed_video_formats:             # 允许的视频格式
    - "mp4"
    - "avi"
    - "mov"
    - "mkv"
    - "webm"
    - "flv"
  allowed_audio_formats:             # 允许的音频格式
    - "mp3"
    - "wav"
    - "aac"
    - "m4a"
    - "ogg"
